{
  "testName": "Merchant API Debug Test",
  "timestamp": "2025-08-01T04:43:58.552Z",
  "testResults": {
    "loginSuccess": false,
    "profileGetSuccess": false,
    "profileUpdateSuccess": false,
    "errors": [],
    "apiResponses": []
  },
  "codeAnalysis": {
    "knownIssues": [
      {
        "file": "server/routes/merchant.js",
        "line": 110,
        "issue": "Undefined variable: editableFields",
        "description": "The route tries to use \"editableFields\" but it's not defined. Should use \"allowedFields\" instead.",
        "severity": "high"
      },
      {
        "file": "server/routes/merchant.js",
        "line": 129,
        "issue": "Undefined variable: merchantId",
        "description": "The route tries to use \"merchantId\" but it should be \"merchant.id\".",
        "severity": "high"
      },
      {
        "file": "server/routes/merchant.js",
        "line": 125,
        "issue": "Using merchantService.update with wrong parameters",
        "description": "The update call doesn't pass tenantId parameter consistently.",
        "severity": "medium"
      }
    ],
    "codeIssues": [
      {
        "line": 110,
        "code": "editableFields.forEach(field => {",
        "issue": "Uses undefined \"editableFields\" instead of \"allowedFields\"",
        "severity": "high"
      },
      {
        "line": 129,
        "code": "const fullMerchant = await merchantService.getFullDetails(merchantId);",
        "issue": "Uses undefined \"merchantId\" variable",
        "severity": "high"
      },
      {
        "line": 129,
        "code": "const fullMerchant = await merchantService.getFullDetails(merchantId);",
        "issue": "getFullDetails called with undefined merchantId",
        "severity": "high"
      }
    ]
  },
  "recommendations": [
    {
      "issue": "Undefined editableFields variable",
      "fix": "Change \"editableFields.forEach\" to \"allowedFields.forEach\" on line ~110",
      "priority": "high"
    },
    {
      "issue": "Undefined merchantId variable",
      "fix": "Change \"getFullDetails(merchantId)\" to \"getFullDetails(merchant.id)\" on line ~129",
      "priority": "high"
    },
    {
      "issue": "Inconsistent tenant ID usage",
      "fix": "Ensure all merchantService calls include tenantId parameter consistently",
      "priority": "medium"
    },
    {
      "issue": "Settings update logic needs improvement",
      "fix": "Standardize settings update pattern across all settings endpoints",
      "priority": "medium"
    }
  ],
  "summary": {
    "loginWorking": false,
    "profileGetWorking": false,
    "profileUpdateWorking": false,
    "totalApiErrors": 0,
    "codeIssuesFound": 3,
    "knownIssuesCount": 3
  }
}